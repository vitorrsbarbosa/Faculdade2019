DECLARE 
  CURSOR C1 IS SELECT CODCLIENTE IDCLIENTE, NOME NOMECLIENTE FROM CLIENTE;
  CURSOR P1 (PCLIENTE IN NUMBER) IS SELECT CODPEDIDO, DATAPEDIDO, VALORTOTAL FROM PEDIDO
      WHERE CODCLIENTE = PCLIENTE;
  CURSOR PROD1 (PCODPEDIDO IN NUMBER) IS SELECT P.DESCRICAO, I.QUANTIDADE 
       FROM PRODUTO P INNER JOIN ITEMPEDIDO I ON P.CODPRODUTO = I.CODPRODUTO
          WHERE I.CODPEDIDO = PCODPEDIDO;
    RC1 C1%ROWTYPE;  -- CRIA UM REGISTRO DE UMA UNICA LINHA, COM A ESTRUTURA DO CURSOR
    RP1 P1%ROWTYPE;
    RPROD PROD1%ROWTYPE;
 BEGIN
    OPEN C1;
    LOOP
       FETCH C1 INTO RC1;
       EXIT WHEN C1%NOTFOUND;
         DBMS_OUTPUT.PUT_LINE('Cliente: ' || RC1.IDCLIENTE || ' ' || RC1.NOMECLIENTE);
         OPEN P1(RC1.IDCLIENTE);
         LOOP
           FETCH P1 INTO RP1;
             EXIT WHEN P1%NOTFOUND;
           DBMS_OUTPUT.PUT_LINE('        Pedido: ' || RP1.CODPEDIDO || ' ' || RP1.DATAPEDIDO || ' ' || RP1.VALORTOTAL);
           --  IMPRESSAO DOS PRODUTOS DO PEDIDO
           OPEN PROD1(P1.CODPEDIDO);
             LOOP
              FETCH PROD1 INTO RPROD;
              EXIT WHEN PROD1%NOTFOUND;
                DBMS_OUTPUT.PUT_LINE('            Produto: ' || RPROD.DESCRICAO || ' ' || RPROD.QUANTIDADE);   
             END LOOP;
             DBMS_OUTPUT.NEW_LINE();
             CLOSE PROD1;
         END LOOP;
         DBMS_OUTPUT.NEW_LINE();
         CLOSE P1;
    END LOOP;
    CLOSE C1;
 END;
  
  
  
--SELECT P.DESCRICAO, I.QUANTIDADE FROM PRODUTO P INNER JOIN ITEMPEDIDO I ON P.CODPRODUTO = I.CODPRODUTO;  